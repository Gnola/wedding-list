<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Home</title>
  <!-- CSS -->
    <link rel="stylesheet" href="/index.css">
    <link rel="stylesheet" href="/normalize.css">
    <link rel="stylesheet" href="/skeleton.css">
  <!-- JS -->
    <!-- RSVP Color -->
    <% for (let i = 0; i < guests.length; i++) { %>
      <% if (guests[i].rsvp === "I'm in!") { %>
        <style> .RSVP<%=guests[i].id%> { color: green;} </style>
      <% } else if (guests[i].rsvp === "Sadly I can't make it") { %>
        <style> .RSVP<%=guests[i].id%> { color: red;} </style>
      <% } else if (guests[i].rsvp === "Not sure yet") {%>
        <style> .RSVP<%=guests[i].id%> { color: blue;} </style>
      <% } %>
    <% } %>
    <!-- GUEST COUNT -->
    <% let guestsIn = [] %>
    <% let guestsOut = [] %>
    <% let guestsNotSure = [] %>
    <% let guestsPlusOne = [] %>
    <% for (var i = 0; i < guests.length; i++) {%>
      <%  if (guests[i].rsvp === "I'm in!") { %>
            <% guestsIn.push(guests[i]) %>
       <% } else if (guests[i].rsvp === "Sadly I can't make it") { %>
            <% guestsOut.push(guests[i]) %>
       <% } else if (guests[i].rsvp === "Not sure yet") { %>
            <% guestsNotSure.push(guests[i]) %>
       <% } if (guests[i].plusOne !== '') { %>
            <% guestsPlusOne.push(guests[i]) %>
      <% } %>
    <% } %>
  </head>

  <body>
  <!-- HEADER -->
    <div class="HEADER">
      <!-- Title -->
        <h1>Wedding Guest List</h1>
      <!-- Log Out -->
        <a class="button" href="/logout">Log Out</a>
    </div>
  <!-- QUICK GUEST ADD -->
    <div class="QUICK-ADD">
      <h4>Quick Add</h4>
      <form action="/guests" method="POST">
        <div class="row">
          Name: <input type="text" name="name">
          +1: <input type="text" name="plusOne">
          RSVP:
            <select name="rsvp">
              <option value="Not sure yet">Not sure yet</option>
              <option value="I'm in!">I'm in!</option>
              <option value="Sadly I can't make it">Sadly I can't make it</option>
            </select>
          Category:
            <select name="category">
              <option value="Other">Other</option>
              <option value="Family">Family</option>
              <option value="Friends">Friends</option>
            </select>
            <input class="button button-primary" type="submit" value="Add Guest">
        </div>
      </form>
    </div>
  <!-- GUEST COUNT -->
    <div class="COUNT">
      <% let sum = (guests.length + guestsPlusOne.length) %>
      <span><strong>Total Guests:</strong> <%=sum%> </span>
      <span><strong>Guests:</strong> <%=guests.length%></span>
      <span><strong>Plus Ones:</strong> <%=guestsPlusOne.length%></span>
    </div>
  <!-- GUEST LIST -->
    <div class="GUESTLIST">
      <!-- GOING -->
      <ul> <span id="going"><strong>Going:</strong><br> <%=guestsIn.length%></span>
        <% for (let i = 0; i < guests.length; i++) { %>
          <% if (guests[i].rsvp === "I'm in!") { %>
          <li>
            <div class="GUESTS" onclick="location.href='/guests/<%=guests[i].id%>';" style="cursor: pointer;">
              <div class="INFO">
                <h4><%=guests[i].name%></h4>
                <strong>+1:</strong>  <%=guests[i].plusOne%><br>
                <strong>RSVP:</strong> <span class="RSVP<%=guests[i].id%>"><%=guests[i].rsvp%></span><br>
                <strong>Category:</strong> <%=guests[i].category%><br>
                <strong>Invited:</strong> <%=guests[i].invited%>
              </div>
              <div class="BUTTONS">
                  <!-- EDIT -->
                <a class="button" href="/guests/<%=guests[i].id%>/edit">Edit</a>
                  <!-- DELETE -->
                <form class="" action="/guests/<%=guests[i].id%>?_method=DELETE" method="POST">
                  <input type="submit" value="DELETE">
                </form> <br>
              </div>
            </div>
          </li>
          <% } %>
        <% } %>
      </ul>
      <!-- NOT GOING -->
      <ul> <span id="notgoing"><strong>Not Going:</strong><br> <%=guestsOut.length%></span>
        <% for (let i = 0; i < guests.length; i++) { %>
          <% if (guests[i].rsvp === "Sadly I can't make it") { %>
          <li>
            <div class="GUESTS" onclick="location.href='/guests/<%=guests[i].id%>';" style="cursor: pointer;">
              <div class="INFO">
                <h4><%=guests[i].name%></h4>
                <strong>+1:</strong>  <%=guests[i].plusOne%><br>
                <strong>RSVP:</strong> <span class="RSVP<%=guests[i].id%>"><%=guests[i].rsvp%></span><br>
                <strong>Category:</strong> <%=guests[i].category%><br>
                <strong>Invited:</strong> <%=guests[i].invited%>
              </div>
              <div class="BUTTONS">
                  <!-- EDIT -->
                <a class="button" href="/guests/<%=guests[i].id%>/edit">Edit</a>
                  <!-- DELETE -->
                <form class="" action="/guests/<%=guests[i].id%>?_method=DELETE" method="POST">
                  <input type="submit" value="DELETE">
                </form> <br>
              </div>
            </div>
          </li>
          <% } %>
        <% } %>
      </ul>
      <!-- UNDECIDED -->
      <ul> <span id="undecided"><strong>Undecided:</strong><br> <%=guestsNotSure.length%></span>
        <% for (let i = 0; i < guests.length; i++) { %>
          <% if (guests[i].rsvp === "Not sure yet") { %>
          <li>
            <div class="GUESTS" onclick="location.href='/guests/<%=guests[i].id%>';" style="cursor: pointer;">
              <div class="INFO">
                <h4><%=guests[i].name%></h4>
                <strong>+1:</strong>  <%=guests[i].plusOne%><br>
                <strong>RSVP:</strong> <span class="RSVP<%=guests[i].id%>"><%=guests[i].rsvp%></span><br>
                <strong>Category:</strong> <%=guests[i].category%><br>
                <strong>Invited:</strong> <%=guests[i].invited%>
              </div>
              <div class="BUTTONS">
                  <!-- EDIT -->
                <a class="button" href="/guests/<%=guests[i].id%>/edit">Edit</a>
                  <!-- DELETE -->
                <form class="" action="/guests/<%=guests[i].id%>?_method=DELETE" method="POST">
                  <input type="submit" value="DELETE">
                </form> <br>
              </div>
            </div>
          </li>
          <% } %>
        <% } %>
      </ul>
  </div>
  <div class="BOTTOM">
    <!-- NEW Guest -->
    <a class="button button-primary" href="/guests/new">Create New</a><br>
  </div>
  </body>
</html>
